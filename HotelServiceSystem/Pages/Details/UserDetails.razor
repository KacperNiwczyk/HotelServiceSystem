@page "/userDetails/{Id:int}"
@using HotelServiceSystem.Interfaces.Services
@using HotelServiceSystem.Entities
@inject IUserService userService
@inject NavigationManager navigationManager

@if (UserModel != null)
{
    <MatAccordion> 
        <MatExpansionPanel Expanded="@PanelExpanded"> 
            <MatExpansionPanelSummary> 
                <MatExpansionPanelHeader>Edit room</MatExpansionPanelHeader> 
            </MatExpansionPanelSummary> 
            <MatExpansionPanelDetails> 
                <HssUserInput UserModel="@UserModel" OnSubmit="@OnUserEdit"></HssUserInput>
            </MatExpansionPanelDetails> 
        </MatExpansionPanel>
    </MatAccordion>
    <div class="card">
        <div class="card-body">
            <p>User name : @UserModel.UserName</p>
            <p>Last login : @UserModel.LastLogin</p>
            <p>Role : @UserModel.UserRole</p>
        </div>
    </div>
}


@code {
    [Parameter]
    public int Id { get; set; }

    private bool PanelExpanded { get; set; }
    
    private User UserModel { get; set; }

    protected override async Task OnInitializedAsync()
    {
        UserModel = userService.GetById(Id);
        await base.OnInitializedAsync();
    }

    private async Task OnUserEdit(User user)
    {
        await userService.UpdateUserAsync(user);
        PanelExpanded = false;
    }
}